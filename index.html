<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModernTech HR Management System</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Vue.js and Vue Router -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/vue-router@4.0.15/dist/vue-router.global.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f6f9;
        }
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div id="app">
        <nav v-if="isLoggedIn" class="navbar navbar-expand-lg navbar-light bg-light mb-4">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">ModernTech HR System</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item" v-if="user.role === 'admin'">
                            <router-link to="/employees" class="nav-link">Employees</router-link>
                        </li>
                        <li class="nav-item" v-if="user.role === 'admin'">
                            <router-link to="/time-off" class="nav-link">Time Off</router-link>
                        </li>
                        <li class="nav-item" v-if="user.role === 'employee'">
                            <router-link to="/employee-dashboard" class="nav-link">Dashboard</router-link>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-danger" @click="logout">Logout</button>
            </div>
        </nav>
        <div class="app-container">
            <router-view></router-view>
        </div>
    </div>

    <script>
        const initDummyData = () => {
            if (!localStorage.getItem('users')) {
                const users = [
                    { username: 'admin', password: 'admin123', role: 'admin' }
                ];
                localStorage.setItem('users', JSON.stringify(users));
            }
            if (!localStorage.getItem('employees')) {
                localStorage.setItem('employees', JSON.stringify([]));
            }
            if (!localStorage.getItem('timeOffRequests')) {
                localStorage.setItem('timeOffRequests', JSON.stringify([]));
            }
        };

        const Login = {
            data() {
                return { username: '', password: '', errorMessage: '' };
            },
            methods: {
                login() {
                    const users = JSON.parse(localStorage.getItem('users') || '[]');
                    const user = users.find(u => u.username === this.username && u.password === this.password);
                    if (user) {
                        localStorage.setItem('loggedInUser', JSON.stringify(user));
                        if (user.role === 'admin') {
                            this.$router.push('/employees');
                        } else {
                            this.$router.push('/employee-dashboard');
                        }
                    } else {
                        this.errorMessage = 'Invalid credentials';
                    }
                }
            },
            template: `
                <div class="mt-5">
                    <h2>Login</h2>
                    <form @submit.prevent="login">
                        <div class="mb-3">
                            <input v-model="username" type="text" placeholder="Username" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <input v-model="password" type="password" placeholder="Password" class="form-control" required />
                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                    </form>
                    <p class="text-danger mt-2">{{ errorMessage }}</p>
                </div>
            `
        };

        const EmployeeManagement = {
            data() {
                return {
                    employees: JSON.parse(localStorage.getItem('employees') || '[]'),
                    newEmployee: { name: '', department: '', salary: '', hireDate: '' }
                };
            },
            methods: {
                generateLogin() {
                    const username = this.newEmployee.name.toLowerCase().replace(/\s/g, '') + Date.now().toString().slice(-4);
                    const password = Math.random().toString(36).substring(2, 8);
                    return { username, password };
                },
                addEmployee() {
                    const { username, password } = this.generateLogin();
                    const employee = {
                        ...this.newEmployee,
                        id: Date.now(),
                        username,
                        password
                    };
                    this.employees.push(employee);
                    const users = JSON.parse(localStorage.getItem('users') || '[]');
                    users.push({ username, password, role: 'employee', employeeId: employee.id });
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('employees', JSON.stringify(this.employees));
                    this.newEmployee = { name: '', department: '', salary: '', hireDate: '' };
                    alert(`Employee added. Username: ${username}, Password: ${password}`);
                }
            },
            template: `
                <div>
                    <h2>Employee Management</h2>
                    <div>
                        <h3>Add New Employee</h3>
                        <form @submit.prevent="addEmployee">
                            <input v-model="newEmployee.name" type="text" placeholder="Name" required />
                            <input v-model="newEmployee.department" type="text" placeholder="Department" required />
                            <input v-model="newEmployee.salary" type="number" placeholder="Salary" required />
                            <input v-model="newEmployee.hireDate" type="date" placeholder="Hire Date" required />
                            <button type="submit">Add Employee</button>
                        </form>
                    </div>
                </div>
            `
        };

        const routes = [
            { path: '/', component: Login },
            { path: '/employees', component: EmployeeManagement },
            { path: '/employee-dashboard', component: { template: '<h2>Employee Dashboard</h2>' } },
        ];

        const router = VueRouter.createRouter({
            history: VueRouter.createWebHashHistory(),
            routes
        });

        const app = Vue.createApp({
            data() {
                return { user: JSON.parse(localStorage.getItem('loggedInUser') || '{}') };
            },
            computed: {
                isLoggedIn() {
                    return !!this.user.username;
                }
            },
            methods: {
                logout() {
                    localStorage.removeItem('loggedInUser');
                    this.user = {};
                    this.$router.push('/');
                }
            }
        });

        app.use(router);
        initDummyData();
        app.mount('#app');
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
</body>
</html>
